<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>ê²Œì‹œê¸€ ìƒì„¸ ë³´ê¸°</title>
</head>
<body>
    <h1>{{ post.title }}</h1>

    <!-- ê²Œì‹œê¸€ ì •ë³´ ì¶œë ¥ -->
    <p>ì‘ì„±ì: {{ post.writer.username }}</p>
    <p>ë‚´ìš©: {{ post.content }}</p>
    <p>ë§í¬: <a href="{{ post.link }}">{{ post.link }}</a></p>
    {% if post.image %}
        <img src="{{ post.image.url }}" alt="ê²Œì‹œê¸€ ì´ë¯¸ì§€" style="width: 200px;height:200px;">
    {% endif %}

    <!-- ê²Œì‹œê¸€ ì¢‹ì•„ìš” ë²„íŠ¼ -->
    <form action="{% url 'post:post_like' post.id %}" method="post" style="display:inline;">
        {% csrf_token %}
        <button type="submit">
            ğŸ‘ {{ post.likes.count }}
        </button>
    </form>

    <hr>

    <!-- ëŒ“ê¸€ ëª©ë¡ -->
    <h3>ëŒ“ê¸€</h3>
    {% for comment in comments %}
        <div style="margin-bottom: 15px;">
            <p><strong>{{ comment.writer.username }}</strong> ({{ comment.created_at|date:"Y-m-d H:i" }})</p>
            <p>{{ comment.content }}</p>

            <!-- ëŒ“ê¸€ ì¢‹ì•„ìš” ë²„íŠ¼ -->
            <form action="{% url 'post:comment_like' post.id comment.id %}" method="post" style="display:inline;">
                {% csrf_token %}
                <button type="submit">
                    ğŸ‘ {{ comment.likes.count }}
                </button>
            </form>

            <!-- ëŒ€ëŒ“ê¸€ ëª©ë¡ -->
            {% for recomment in comment.recomment_set.all %}
                <div style="margin-left: 30px; margin-top: 5px;">
                    <p><strong>{{ recomment.writer.username }}</strong> ({{ recomment.created_at|date:"Y-m-d H:i" }})</p>
                    <p>{{ recomment.recomment }}</p>

                    <!-- ëŒ€ëŒ“ê¸€ ì¢‹ì•„ìš” ë²„íŠ¼ -->
                    <form action="{% url 'post:recomment_like' post.id recomment.id %}" method="post" style="display:inline;">
                        {% csrf_token %}
                        <button type="submit">
                            ğŸ‘ {{ recomment.likes.count }}
                        </button>
                    </form>
                </div>
            {% endfor %}

            <!-- ëŒ€ëŒ“ê¸€ ì‘ì„± í¼ -->
            <form action="{% url 'post:recomment' post.id %}" method="post">
                {% csrf_token %}
                {{ recomment_form.as_p }}
                <input type="hidden" name="comment_id" value="{{ comment.id }}">
                <button type="submit">ëŒ€ëŒ“ê¸€ ì‘ì„±</button>
            </form>
        </div>
    {% endfor %}

    <!-- ëŒ“ê¸€ ì‘ì„± í¼ -->
    <hr>
    <h3>ëŒ“ê¸€ ì‘ì„±</h3>
    <form action="{% url 'post:comment' post.id %}" method="post">
        {% csrf_token %}
        {{ comment_form.as_p }}
        <button type="submit">ëŒ“ê¸€ ì‘ì„±</button>
    </form>
</body>
</html>
